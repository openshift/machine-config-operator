mode: 0644
path: "/etc/kubernetes/credential-providers/ecr-credential-provider.yaml"
contents:
  inline: |
    apiVersion: kubelet.config.k8s.io/v1
    kind: CredentialProviderConfig
    providers:
      - name: ecr-credential-provider
        matchImages:
          - "*.dkr.ecr.*.amazonaws.com"
          - "*.dkr.ecr.*.amazonaws.com.cn"
          - "*.dkr.ecr-fips.*.amazonaws.com"
          - "*.dkr.ecr.us-iso-east-1.c2s.ic.gov"
          - "*.dkr.ecr.us-isob-east-1.sc2s.sgov.gov"
        defaultCacheDuration: "12h"
        apiVersion: credentialprovider.kubelet.k8s.io/v1
      - name: crio-credential-provider
        matchImages:
          - docker.io
        defaultCacheDuration: "1s"
        apiVersion: credentialprovider.kubelet.k8s.io/v1
        tokenAttributes:
          serviceAccountTokenAudience: https://kubernetes.default.svc
          cacheType: "Token"
          requireServiceAccount: false
