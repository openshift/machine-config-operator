name: kubelet-dynamic-node-size.service
enabled: true
contents: |
  [Unit]
  Description=Dynamically sets the system reserved for the kubelet
  Wants=network-online.target
  After=network-online.target ignition-firstboot-complete.service
  Before=kubelet.service crio.service

  [Service]
  # Need oneshot to delay kubelet
  Type=oneshot
  RemainAfterExit=yes
  ExecStart=/bin/bash /usr/local/sbin/dynamic-system-reserved-calc.sh

  [Install]
  RequiredBy=kubelet.service
